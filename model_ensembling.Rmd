---
title: "model_ensembling"
author: "Jiaqi Chen"
date: "2022-10-12"
output: pdf_document
---

```{r, warning=FALSE}
library(data.table)
library(readxl)
library(tidyverse)
library(VIM)
library(dplyr)
library(recipes)
library(caret)
library(ranger)
library(pROC)
library(xgboost)
library(keras)
library(tfruns)
library(mice)
```


```{r}
load("final.Rdata")
load("glmn_pred.Rdata")
glmn_pred = glmn.pred
```

# Ensemble XGBoost and LightGBM
### Averaging
```{r}
#Taking average of predictions
average_pred <- lgb_pred*0.2 + glmn_pred*0.8
roc(y2_lgb, average_pred)

roc(y2_lgb, lgb_pred) #LightGBM 0.7343
roc(y2_lgb, glmn_pred) #GLMN 0.7313
roc(y2_lgb, pred3$data$prob.0)

#AUC: 0.7267 (XGboost 0.7057, LightGBM 0.7343)
#0.7329
```


